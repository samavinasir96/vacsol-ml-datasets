<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>VacSol-ML Dataset</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0f1724;
  --card:#0b1220;
  --muted:#9aa7bf;
  --accent:#6ee7b7;
  --blue:#60a5fa;
}

html,body{
  margin:0;
  font-family:Inter,system-ui;
  background:linear-gradient(180deg,#071227,#08182a);
  color:#dce9f6;
}

.wrap{
  max-width:1200px;
  margin:auto;
  padding:28px;
}

.card{
  background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:14px;
  padding:22px;
  margin-bottom:20px;
}

h1{font-size:26px;margin-top:0}
h2{font-size:18px;margin-bottom:10px}
h3{font-size:15px;margin-bottom:6px}
p{line-height:1.6}
.small{font-size:13px;color:var(--muted)}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

td,th{
  padding:10px;
  border-bottom:1px solid rgba(255,255,255,0.06);
  text-align:left;
}

code{
  background:#020617;
  padding:3px 6px;
  border-radius:6px;
  font-size:13px;
}

select,button{
  width:100%;
  padding:9px;
  border-radius:8px;
  background:#0b1220;
  color:#dce9f6;
  border:1px solid rgba(255,255,255,0.08);
}

button{
  cursor:pointer;
  font-weight:600;
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}

.chart-box{
  height:240px;
  position:relative;
}

footer{
  text-align:center;
  font-size:13px;
  color:var(--muted);
  margin-top:30px;
}

@media(max-width:900px){
  .grid{grid-template-columns:1fr}
}
</style>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>

<body>
<div class="wrap">

<!-- INTRO -->
<section class="card">
<h1>VacSol-ML Dataset</h1>
<p>
VacSol-ML is a <b>machine-learning–ready benchmark dataset</b> for
<b>vaccine candidate prediction</b>, integrating protein sequence–derived
physicochemical and immunological features.
</p>
</section>

<!-- OVERVIEW -->
<section class="card">
<h2>Dataset Overview</h2>
<table>
<tr><th>Samples</th><td>412 protein sequences</td></tr>
<tr><th>Features</th><td>~894 numerical features</td></tr>
<tr><th>Label</th><td><code>Final_predictions</code> (0 / 1)</td></tr>
<tr><th>Format</th><td>CSV</td></tr>
</table>
</section>

<!-- GLOBAL STATS -->
<section class="card">
<h2>Global Dataset Statistics</h2>

<div class="grid">

<div class="card">
<h3>Class Distribution</h3>
<p class="small">Vaccine vs non-vaccine candidates</p>
<div class="chart-box"><canvas id="classChart"></canvas></div>
</div>

<div class="card">
<h3>Feature Composition</h3>
<p class="small">Approximate distribution of feature groups</p>
<div class="chart-box"><canvas id="featureGroupChart"></canvas></div>
</div>

<div class="card" style="grid-column:1/-1">
<h3>Physicochemical Feature Summary</h3>
<p class="small">Mean ± standard deviation across proteins</p>
<div class="chart-box"><canvas id="physchemChart"></canvas></div>
</div>

</div>
</section>

<!-- CONTROLS -->
<section class="card">
<h2>Dataset Selection</h2>
<div class="grid">
<div>
<label class="small">Dataset</label>
<select id="datasetSelect">
  <option value="dataset1">VacSol-ML Dataset</option>
  <option value="dataset2">VacSol-ML Extended Dataset</option>
</select>
</div>
<div>
<button id="downloadBtn" style="margin-top:22px">⬇ Download CSV</button>
</div>
</div>
</section>

<footer>
VacSol-ML Dataset · Public ML Benchmark · GitHub Pages
</footer>

</div>

<script>
const COMMIT="0b22d317414da667d8224d16f56f36a7216d3a16";
const BASE=`https://raw.githubusercontent.com/samavinasir96/vacsol-ml-datasets/${COMMIT}/`;
const FILES={
 dataset1:BASE+"VacSol-ML%20Dataset.csv",
 dataset2:BASE+"VacSol-ML_DataSet_new_original.csv"
};

let data={}, charts={};

function loadCSV(key){
 return new Promise(res=>{
  Papa.parse(FILES[key],{
   download:true,header:true,skipEmptyLines:true,
   complete:r=>res(r.data)
  });
 });
}

Promise.all([loadCSV("dataset1"),loadCSV("dataset2")]).then(d=>{
 data.dataset1=d[0];
 data.dataset2=d[1];
 renderAll("dataset1");
});

function mean(arr){return arr.reduce((a,b)=>a+b,0)/arr.length}
function std(arr){
 const m=mean(arr);
 return Math.sqrt(mean(arr.map(x=>(x-m)**2)));
}

function renderAll(key){
 const rows=data[key];
 downloadBtn.onclick=()=>window.open(FILES[key]);
 renderClassDistribution(rows);
 renderFeatureGroups(rows);
 renderPhysChem(rows);
}

function renderClassDistribution(rows){
 const c={0:0,1:0};
 rows.forEach(r=>c[r.Final_predictions]++);
 if(charts.class) charts.class.destroy();
 charts.class=new Chart(classChart,{
  type:"bar",
  data:{
   labels:["Non-vaccine (0)","Vaccine (1)"],
   datasets:[{data:[c[0],c[1]],backgroundColor:["#60a5fa","#6ee7b7"]}]
  },
  options:{maintainAspectRatio:false,plugins:{legend:{display:false}}}
 });
}

function renderFeatureGroups(rows){
 const cols=Object.keys(rows[0]);
 let phys=0, immuno=0, auto=0, other=0;
 cols.forEach(c=>{
  if(/mhc|rank|antigen/i.test(c)) immuno++;
  else if(/lag|CID|Moreau/i.test(c)) auto++;
  else if(/weight|hydropathy|aromatic|isoelectric/i.test(c)) phys++;
  else other++;
 });
 if(charts.groups) charts.groups.destroy();
 charts.groups=new Chart(featureGroupChart,{
  type:"doughnut",
  data:{
   labels:["Physicochemical","Immunogenicity","Auto-correlation","Other"],
   datasets:[{data:[phys,immuno,auto,other]}]
  },
  options:{maintainAspectRatio:false}
 });
}

function renderPhysChem(rows){
 const keys=["molecular_weight","hydropathy","aromaticity"];
 const labels=[], means=[], errs=[];
 keys.forEach(k=>{
  const col=Object.keys(rows[0]).find(c=>c.toLowerCase().includes(k));
  if(!col) return;
  const v=rows.map(r=>+r[col]).filter(x=>!isNaN(x));
  labels.push(col);
  means.push(mean(v));
  errs.push(std(v));
 });
 if(charts.phys) charts.phys.destroy();
 charts.phys=new Chart(physchemChart,{
  type:"bar",
  data:{
   labels,
   datasets:[
    {label:"Mean",data:means,backgroundColor:"#6ee7b7"},
    {label:"Std Dev",data:errs,backgroundColor:"#60a5fa"}
   ]
  },
  options:{maintainAspectRatio:false}
 });
}

datasetSelect.onchange=()=>renderAll(datasetSelect.value);
</script>

</body>
</html>
